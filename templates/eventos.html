<!-- templates/eventos.html -->

{% extends 'parciales/base.html' %}

{% block estilos_extra %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/carrusel.css') }}">
{% endblock %}

{% block titulo %}Inicio{% endblock %}

{% block contenido %}

<div class="carrusel-container">
    <button class="carrusel-btn izquierda" onclick="moverCarrusel(-1)">‹</button>
    <div class="carrusel-track" id="carrusel-track">
        {% for item in slider %}
        <div class="carrusel-item">
            <img src="{{ url_for('static', filename='img/' ~ item.img) }}" alt="Imagen">
            <div class="leyenda">{{ item.texto }}</div>
        </div>
        {% endfor %}
                {% for item in slider %}
        <div class="carrusel-item">
            <img src="{{ url_for('static', filename='img/' ~ item.img) }}" alt="Imagen">
            <div class="leyenda">{{ item.texto }}</div>
        </div>
        {% endfor %}
        <button class="carrusel-btn derecha" onclick="moverCarrusel(1)">›</button>
    </div>
</div>

{% endblock %}

{% block scripts_extra %}
    <script>
        const carrusel = document.querySelector('.carrusel-container');
        const items = document.querySelectorAll('.carrusel-item');
        let desplazamiento = 0;

        setInterval(() => {
            index = (index + 1) % items.length;
            const item = items[index];
            const destino = item.offsetLeft - (carrusel.offsetWidth - item.offsetWidth) / 2;
            scrollSuave(carrusel, destino);
        }, 3000);

        let index = 0;

        function moverCarrusel(direccion) {
            index = Math.max(0, Math.min(index + direccion, items.length - 1));
            const item = items[index];
            const destino = item.offsetLeft - (carrusel.offsetWidth - item.offsetWidth) / 2;
            scrollSuave(carrusel, destino);
        }

        function scrollSuave(elemento, destino, duracion = 1200) {
            const inicio = elemento.scrollLeft;
            const distancia = destino - inicio;
            const inicioTiempo = performance.now();

            function animarScroll(tiempoActual) {
                const tiempoPasado = tiempoActual - inicioTiempo;
                const progreso = Math.min(tiempoPasado / duracion, 1);
                const desplazamiento = inicio + distancia * easeOutQuad(progreso);
                elemento.scrollLeft = desplazamiento;

                if (progreso < 1) {
                    requestAnimationFrame(animarScroll);
                }
            }

            function easeOutQuad(t) {
                return t * (2 - t);
            }

            requestAnimationFrame(animarScroll);
        }

    </script>
{% endblock %}